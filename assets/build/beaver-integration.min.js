var be=Object.defineProperty;var c=(y,w)=>be(y,"name",{value:w,configurable:!0});(function(){"use strict";(function(){const e={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,e);return}}catch(t){}globalThis.process={env:e}})();var y=Object.defineProperty,w=c((e,t)=>y(e,"name",{value:t,configurable:!0}),"l$1");class g{constructor(t){this.conditionsMap=t||[],this.getPreviousLevels=this.getPreviousLevels.bind(this),this.getCondition=this.getCondition.bind(this)}evaluateConditions(t,n){let i=!0;if(!t||!Array.isArray(t))return i;for(const o of t){const s=this.getCondition(o);if(!this.evaluateCondition(s,n))return!1}return i}getCondition(t){var n;const i=t.split("-"),o=parseInt(i[0]),s=parseInt(i[1]);return{number:o,level:s,current:(n=this.conditionsMap[o])==null?void 0:n[s],previousLevels:this.getPreviousLevels(o,s)}}getPreviousLevels(t,n){if(n===0)return[];let i=0;const o=[];for(;i<n;)o.push(this.conditionsMap[t][i]),i++;return o}extractComparisons(t){const n=[];for(const i in t)if(!(i==="compare"||i.slice(0,8)==="compare_"||i==="value"||i.slice(0,6)==="value_")){if(i==="control"||i.slice(0,8)==="control_"){const o=t[i],[s,a=0]=i.split("_");n.push({field:o,value:t[`value${a?"_"+a:""}`],compare:t[`compare${a?"_"+a:""}`]});continue}n.push({field:i,value:t[i]})}return n}evaluateCondition(t,n){let i=!0;for(const s of t.previousLevels){const a=this.extractComparisons(s);for(const{field:l,value:r,compare:d}of a){const u=n(l);if(this.compare(u,r,d))return!1}}const o=this.extractComparisons(t.current);for(const{field:s,value:a,compare:l}of o){const r=n(s);if(!this.compare(r,a,l))return!1}return i}compare(t,n,i="is"){let o=!1;switch(i){case"is":case"equal":case"not":default:o=t===n,i==="not"&&(o=!o);break}return o}}c(g,"u$1"),w(g,"ControlVisibility");var H=Object.defineProperty,f=c((e,t)=>H(e,"name",{value:t,configurable:!0}),"a$3");const v=jQuery,k=f((e,t)=>{t(),e.find("select").on("change",t),e.find("input").on("change",t),e.find("input[type=text], input[type=number]").on("input",t);const n=e.find(".fl-editor-field");n.each(i=>{const o=j(n[i]);o&&o.on("change",t)})},"onFormChange"),N=f((e,t)=>{const n=e.find("select, input, .fl-editor-field"),i={};return n.each(o=>{const s=T(n[o]);!s||(s.conditions=t[s.name]||!1,s.element=n[o],i[s.name]=s)}),i},"getFormFields"),T=f(e=>{switch(e.tagName){case"SELECT":if(e.multiple)return e.name!==""?{name:e.name,value:v(e).val().join(",")}:!1;case"INPUT":return e.name!==""?{name:e.name,value:v(e).val()}:!1;case"DIV":const t=v(e).attr("data-name"),n=j(e);return{name:t,value:n.getContent()}}return!1},"getFormField"),j=f(e=>{const t=v(e).find(".wp-editor-tabs button").attr("data-wp-editor-id");return window.tinyMCE?window.tinyMCE.get(t):!1},"getEditor");var V=Object.defineProperty,m=c((e,t)=>V(e,"name",{value:t,configurable:!0}),"r$2");const O=jQuery,I=m(e=>{FLBuilder.addHook("settings-form-init",()=>{const t=m((i,o)=>Q(e,o),"init"),n=m(()=>{FLBuilder.removeHook("didCompleteAJAX",t),FLBuilder.removeHook("didHideLightbox",n)},"clear");FLBuilder.addHook("didCompleteAJAX",t),FLBuilder.addHook("didHideLightbox",n)})},"init"),Q=m((e,t)=>{var n,i,o,s;if(!t.fl_builder_data)return;const a=(n=t.fl_builder_data.form)!=null?n:"";(i=t.settings)!=null;const l=`_tangible_repeater_${e.blockId}_`;if(!a.startsWith(l))return;const r=a.replace(l,""),d=(s=((o=e.conditions.repeater)!=null?o:{})[r])!=null?s:!1;if(!d)return;const u=new g(d),p=O(`form[data-form-id=${a}]`);!p||k(p,()=>J(p,e,u,r))},"initVisibility"),J=m((e,t,n,i)=>{var o;const s=N(e,(o=t.repeaters[i])!=null?o:{}),a=m(l=>s[l]?s[l].value:void 0,"getValue");for(const l in s){const r=s[l];if(!r.conditions||!r.conditions.length)continue;const d=n.evaluateConditions(r.conditions,a);O(r.element).closest(".fl-field")[d?"show":"hide"]()}},"setVisibility");var D=Object.defineProperty,C=c((e,t)=>D(e,"name",{value:t,configurable:!0}),"l");const $=jQuery,X=C(e=>{const t=new g(e.conditions.general);k(e.form,()=>q(e,t)),I(e)},"init"),q=C((e,t)=>{const n=e.getTabSettings(),i=e.getSectionSettings(),o=N(e.form,e.fields),s=C(a=>o[a]?o[a].value:void 0,"getFieldValue");for(const a in n){const l=n[a];if(!l.conditions||!l.conditions.length)continue;const r=t.evaluateConditions(l.conditions,s),d=$(l.element);d.hasClass("fl-active")||d[r?"show":"hide"]()}for(const a in i){const l=i[a];if(!l.conditions||!l.conditions.length)continue;const r=t.evaluateConditions(l.conditions,s);$(l.element)[r?"show":"hide"]()}for(const a in o){const l=o[a];if(!l.conditions||!l.conditions.length)continue;const r=t.evaluateConditions(l.conditions,s);$(l.element).closest(".fl-field")[r?"show":"hide"]()}},"setVisibility");var z=Object.defineProperty,U=c((e,t)=>z(e,"name",{value:t,configurable:!0}),"g$2");const{blockConfig:{slug:W,visibility:b}}=Tangible,G=jQuery,K=U(e=>{const t=W+e;FLBuilder.registerModuleHelper(t,{init(){this.bindMethods(),this.form=G(".fl-builder-settings"),this.blockId=e,this.tabs=b.tabs[e]||{},this.sections=b.sections[e]||{},this.fields=b.fields[e]||{},this.repeaters=b.repeaters[e]||{},this.conditions=b.conditions[e]||{},!(!Object.keys(this.tabs).length&&!Object.keys(this.sections).length&&!Object.keys(this.fields).length)&&X(this)},bindMethods(){this.getTabSettings=this.getTabSettings.bind(this),this.getSectionSettings=this.getSectionSettings.bind(this)},getTabSettings(){const n={},i=this.form.find(".fl-builder-settings-tabs a");return i.each(o=>{const s=i[o],a=s.getAttribute("href").replace("#fl-builder-settings-tab-","");if(!a)return;const l={name:a};l.conditions=this.tabs[l.name]||!1,l.element=s,n[l.name]=l}),n},getSectionSettings(){const n={},i=this.form.find(".fl-builder-settings-section");return i.each(o=>{const s=i[o],a=s.getAttribute("id").replace("fl-builder-settings-section-","");if(!a)return;const l={name:a};l.conditions=this.sections[l.name]||!1,l.element=s,n[l.name]=l}),n}})},"initModule"),{blockConfig:R}=window.Tangible,{fields:Y}=R.visibility;jQuery(()=>{for(const e in Y)K(e)});var Z=Object.defineProperty,ee=c((e,t)=>Z(e,"name",{value:t,configurable:!0}),"i$1");const te=ee(e=>wp.element.createElement("div",{id:"tangible-logic-root",className:"tangible-logic-open"},wp.element.createElement("div",{className:"tangible-logic-modal"},wp.element.createElement("div",{className:"tangible-logic-header"},wp.element.createElement("div",{className:"tangible-logic-title"},e.title?e.title:""),wp.element.createElement("button",{id:"logic-button-cancel",className:"tangible-components-button has-icon",type:"button","aria-label":"Close dialog",onClick:e.cancel},wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",role:"img","aria-hidden":"true",focusable:"false"},wp.element.createElement("path",{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})))),wp.element.createElement("div",{className:"tangible-logic-rule-group"},e.children),wp.element.createElement("div",{className:"tangible-logic-actions tangible-logic-clear"},wp.element.createElement("button",{id:"logic-button-cancel",className:"tangible-components-button is-tertiary",type:"button",onClick:e.cancel},"Cancel"),wp.element.createElement("button",{id:"logic-button-add-logic",className:"tangible-components-button is-primary",type:"button",onClick:e.submit},"Save")))),"Modal");var L=Object.defineProperty,S=Object.getOwnPropertySymbols,ne=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable,_=c((e,t,n)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,"e$1"),oe=c((e,t)=>{for(var n in t||(t={}))ne.call(t,n)&&_(e,n,t[n]);if(S)for(var n of S(t))ie.call(t,n)&&_(e,n,t[n]);return e},"s"),le=c((e,t)=>L(e,"name",{value:t,configurable:!0}),"y");const se=le((e,t,n,i)=>tangibleFields(oe({onChange:o=>t(Array.isArray(o)||typeof o=="object"?JSON.stringify(o):o),value:n},i)),"getControl");var ae=Object.defineProperty,h=c((e,t)=>ae(e,"name",{value:t,configurable:!0}),"e");const re=h(e=>{const{config:t,field:n,builder:i,initialValue:o}=e,s=t.popup,[a,l]=wp.element.useState(i==="beaver-builder"),[r=o,d]=wp.element.useState(),[u=o,p]=wp.element.useState(),ue=h(B=>(s||p(B),d(B)),"save");wp.element.useEffect(()=>e.save(u),[u]),wp.element.useEffect(()=>s&&a&&d(u),[a]);const P=wp.element.createElement("div",{className:`tangible-block-control tangible-block-control-${t.type}`},se(t,ue,u,n));if(!s)return P;const me=h(()=>l(!1),"cancel"),pe=h(()=>{l(!1),p(r)},"submit"),M=i!=="beaver-builder"&&wp.element.createElement("div",{className:`tangible-control-modal-button-container tangible-control-modal-button-container-${i}`},i==="elementor"&&wp.element.createElement("label",{className:"elementor-control-title"},n.label),wp.element.createElement("button",{onClick:()=>l(!a),class:"components-button is-secondary tangible-control-btn"},"Open Settings"));return a?wp.element.createElement(wp.element.Fragment,null,M,wp.element.createElement(te,{submit:pe,cancel:me,title:n.label},P)):M},"Control");var ce=Object.defineProperty,E=c((e,t)=>ce(e,"name",{value:t,configurable:!0}),"r");const{blockConfig:{controls:F}}=Tangible,x=jQuery;x(()=>{for(const e in F)de(F[e])});const de=E(e=>{FLBuilder.addHook("didShowLightbox",()=>{const t=document.getElementsByClassName(`${e.prefixed_type}-container`);if(t.length!==0)for(let n=0;n<t.length;n++){const i=t[n],o=x(i).next(),s=JSON.parse(i.getAttribute("data-field"));if(!e.popup){wp.element.render(A(e,o,s),i);continue}const a=document.createElement("div");a.setAttribute("class",`${e.prefixed_type}-popup-container`),document.body.append(a);const l=`tangible-block-control-button ${e.prefixed_type}-popup-container`;wp.element.render(wp.element.createElement("button",{className:l,onClick:E(()=>{wp.element.unmountComponentAtNode(a),wp.element.render(A(e,o,field),a)},"onClickAction")},"Open Settings"),i)}}),FLBuilder.addHook("settings-lightbox-closed",()=>{const t=document.getElementsByClassName(`tangible-block-control-${e.prefixed_type}-container`);if(t.length===0)return;for(let i=0;i<t.length;i++)wp.element.unmountComponentAtNode(t[i]);if(!e.popup)return;const n=document.getElementsByClassName(`${e.prefixed_type}-popup-container`);for(let i=0;i<n.length;i++)wp.element.unmountComponentAtNode(n[i])})},"initControl"),A=E((e,t,n)=>wp.element.createElement(re,{config:e,initialValue:t.val(),builder:"beaver-builder",field:n,save:i=>{t.val(i),t.trigger("change")}}),"initComponent")})();
//# sourceMappingURL=beaver-integration.min.js.map
