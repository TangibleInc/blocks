var ie=Object.defineProperty;var s=(w,h)=>ie(w,"name",{value:h,configurable:!0});(function(){"use strict";(function(){const e={env:{NODE_ENV:"production"}};try{if(process){process.env=Object.assign({},process.env),Object.assign(process.env,e);return}}catch(t){}globalThis.process={env:e}})();var w=Object.defineProperty,h=s((e,t)=>w(e,"name",{value:t,configurable:!0}),"l");class y{constructor(t){this.conditionsMap=t||[],this.getPreviousLevels=this.getPreviousLevels.bind(this),this.getCondition=this.getCondition.bind(this)}evaluateConditions(t,n){let l=!0;if(!t||!Array.isArray(t))return l;for(const a of t){const i=this.getCondition(a);if(!this.evaluateCondition(i,n))return!1}return l}getCondition(t){var n;const l=t.split("-"),a=parseInt(l[0]),i=parseInt(l[1]);return{number:a,level:i,current:(n=this.conditionsMap[a])==null?void 0:n[i],previousLevels:this.getPreviousLevels(a,i)}}getPreviousLevels(t,n){if(n===0)return[];let l=0;const a=[];for(;l<n;)a.push(this.conditionsMap[t][l]),l++;return a}extractComparisons(t){const n=[];for(const l in t)if(!(l==="compare"||l.slice(0,8)==="compare_"||l==="value"||l.slice(0,6)==="value_")){if(l==="control"||l.slice(0,8)==="control_"){const a=t[l],[i,r=0]=l.split("_");n.push({field:a,value:t[`value${r?"_"+r:""}`],compare:t[`compare${r?"_"+r:""}`]});continue}n.push({field:l,value:t[l]})}return n}evaluateCondition(t,n){let l=!0;for(const i of t.previousLevels){const r=this.extractComparisons(i);for(const{field:m,value:b,compare:u}of r){const o=n(m);if(this.compare(o,b,u))return!1}}const a=this.extractComparisons(t.current);for(const{field:i,value:r,compare:m}of a){const b=n(i);if(!this.compare(b,r,m))return!1}return l}compare(t,n,l="is"){let a=!1;switch(l){case"is":case"equal":case"not":default:a=t===n,l==="not"&&(a=!a);break}return a}}s(y,"u"),h(y,"ControlVisibility");var S=Object.defineProperty,L=s((e,t)=>S(e,"name",{value:t,configurable:!0}),"i$3");const j=L(e=>wp.element.createElement("div",{id:"tangible-logic-root",className:"tangible-logic-open"},wp.element.createElement("div",{className:"tangible-logic-modal"},wp.element.createElement("div",{className:"tangible-logic-header"},wp.element.createElement("div",{className:"tangible-logic-title"},e.title?e.title:""),wp.element.createElement("button",{id:"logic-button-cancel",className:"tangible-components-button has-icon",type:"button","aria-label":"Close dialog",onClick:e.cancel},wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",role:"img","aria-hidden":"true",focusable:"false"},wp.element.createElement("path",{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})))),wp.element.createElement("div",{className:"tangible-logic-rule-group"},e.children),wp.element.createElement("div",{className:"tangible-logic-actions tangible-logic-clear"},wp.element.createElement("button",{id:"logic-button-cancel",className:"tangible-components-button is-tertiary",type:"button",onClick:e.cancel},"Cancel"),wp.element.createElement("button",{id:"logic-button-add-logic",className:"tangible-components-button is-primary",type:"button",onClick:e.submit},"Save")))),"Modal");var E=Object.defineProperty,k=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,C=s((e,t,n)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,"i$2"),A=s((e,t)=>{for(var n in t||(t={}))x.call(t,n)&&C(e,n,t[n]);if(k)for(var n of k(t))B.call(t,n)&&C(e,n,t[n]);return e},"s$2"),R=s((e,t)=>E(e,"name",{value:t,configurable:!0}),"y");const F=R((e,t,n)=>tangibleFields.render(A({onChange:l=>e(Array.isArray(l)||typeof l=="object"?JSON.stringify(l):String(l)),value:t},n)),"getControl");var M=Object.defineProperty,v=s((e,t)=>M(e,"name",{value:t,configurable:!0}),"t");const T=v(e=>{const{config:t,field:n,builder:l,initialValue:a}=e,i=t.popup,[r,m]=wp.element.useState(l==="beaver-builder"),[b=a,u]=wp.element.useState(),[o=a,d]=wp.element.useState(),g=v(P=>(i||d(P),u(P)),"save");wp.element.useEffect(()=>e.save(o),[o]),wp.element.useEffect(()=>i&&r&&u(o),[r]);const $=wp.element.createElement("div",{className:`tangible-block-control tangible-block-control-${t.type}`},F(g,o,n));if(!i)return $;const oe=v(()=>m(!1),"cancel"),ae=v(()=>{m(!1),d(b)},"submit"),O=l!=="beaver-builder"&&wp.element.createElement("div",{className:`tangible-control-modal-button-container tangible-control-modal-button-container-${l}`},l==="elementor"&&wp.element.createElement("label",{className:"elementor-control-title"},n.label),wp.element.createElement("button",{onClick:()=>m(!r),class:"components-button is-secondary tangible-control-btn"},"Open Settings"));return r?wp.element.createElement(wp.element.Fragment,null,O,wp.element.createElement(j,{submit:ae,cancel:oe,title:n.label},$)):O},"Control");var I=Object.defineProperty,V=s((e,t)=>I(e,"name",{value:t,configurable:!0}),"n");const{components:{BaseControl:q}}=wp,{blockConfig:{controls:_}}=Tangible,z=V((e,t,n)=>{const l=`tangible-block-editor-control-${e.type}`;if(_[e.type]){const a=_[e.type];return wp.element.createElement(q,{label:e.label,className:l},wp.element.createElement(T,{config:a,initialValue:t,builder:"gutenberg",field:e,save:i=>n({[e.name]:i})}))}},"getField");var D=Object.defineProperty,f=s((e,t)=>D(e,"name",{value:t,configurable:!0}),"o");const{wp:c,Tangible:J}=window,{blockEditor:{InspectorControls:G},blocks:{registerBlockType:H},components:{Panel:K,PanelBody:Q,PanelRow:U},element:{useState:W,createContext:X},i18n:{__:re},serverSideRender:Y}=c,{blockConfig:p,moduleLoader:Z,ServerSideRender:ee=Y}=J,te=X(),ne=f(e=>{const t=`${p.package}/${e.universal_id?"block-"+e.universal_id:e.name}`;H(t,{title:e.label,description:e.description?e.description:"",category:p.category,sections:e.sections,icon:p.icon,edit(n){const{block_id:l}=n.attributes,[a,i]=W(e.tabs[0]),r=p.conditions[e.universal_id?e.universal_id:e.content_id],m=new y(r.general),b=f(o=>Number.isInteger(n.attributes[o])?n.attributes[o].toString():n.attributes[o],"getFieldValue"),u=f(o=>m.evaluateConditions(o,b),"isVisible");return l||n.setAttributes({block_id:n.clientId}),n.attributes.current_post_id||n.setAttributes({current_post_id:p.current_post_id}),c.element.createElement(c.element.Fragment,null,c.element.createElement(G,null,e.tabs.length>1&&c.element.createElement("div",{className:"tangible-block-editor-tabs"},e.tabs.map(o=>(o.name===a.name||u(o.conditions))&&c.element.createElement("div",{key:`tab-${o.name}`,className:"tangible-block-editor-tab components-button edit-post-sidebar__panel-tab"+(o.name===a.name?" is-active":""),onClick:()=>i(o)},c.element.createElement("p",null,o.label==="default"?"Content":o.label)))),c.element.createElement(te.Provider,{value:{id:l,conditions:r}},a.sections.map((o,d)=>u(o.conditions)&&c.element.createElement(K,{key:`${o.name}-panel-${d}`,className:"tangible-block-editor-section"},c.element.createElement(Q,{title:o.label,initialOpen:d===0},o.fields.map(g=>u(g.conditions)&&c.element.createElement(U,null,z(g,n.attributes[g.name],n.setAttributes)))))))),c.element.createElement(ee,{block:t,attributes:n.attributes,httpMethod:"POST",EmptyResponsePlaceholder:N,LoadingResponsePlaceholder:N,onFetchResponseRendered:o=>{Z(o)}}))},save(){return null}})},"createBlock"),N=f(()=>c.element.createElement("div",{className:"tangible-loop-block"},"\xA0"),"EmptyLoopBlock"),{blocks:le}=window.Tangible;le.map(e=>ne(e))})();
//# sourceMappingURL=gutenberg-integration.min.js.map
